// Generated by LiveScript 1.5.0
(function(){
  var substitutions, fix_input_string, leftpad_to_two, sorted_by_date, check_clicked, sunetid_keydown, out$ = typeof exports != 'undefined' && exports || this;
  substitutions = {
    '02/10: TBD': '02/10: Alex Leavitt',
    '03/10: TBD': '03/10: Shumin Zhai'
  };
  fix_input_string = function(input_string){
    var ref$;
    return (ref$ = substitutions[input_string]) != null ? ref$ : input_string;
  };
  leftpad_to_two = function(num){
    if (0 <= num && num <= 9) {
      return '0' + num;
    }
    return num.toString();
  };
  out$.sorted_by_date = sorted_by_date = function(input_strings){
    var output, i$, len$, input_string, colon_idx, date, remainder, ref$, month, day, date_new;
    output = [];
    for (i$ = 0, len$ = input_strings.length; i$ < len$; ++i$) {
      input_string = input_strings[i$];
      if ((input_string != null ? input_string.trim : void 8) == null) {
        continue;
      }
      input_string = input_string.trim();
      input_string = fix_input_string(input_string);
      colon_idx = input_string.indexOf(':');
      if (colon_idx === -1) {
        colon_idx = input_string.indexOf('-');
      }
      if (colon_idx === -1) {
        output.push(input_string);
        continue;
      }
      date = input_string.substr(0, colon_idx);
      remainder = input_string.substr(colon_idx);
      if (date.indexOf('/') === -1) {
        output.push(input_string);
        continue;
      }
      ref$ = date.split('/'), month = ref$[0], day = ref$[1];
      if (month == null || day == null) {
        output.push(input_string);
        continue;
      }
      month = parseInt(month.trim());
      day = parseInt(day.trim());
      if (isNaN(month) || isNaN(day)) {
        continue;
      }
      date_new = leftpad_to_two(month) + '/' + leftpad_to_two(day);
      output.push(date_new + remainder);
    }
    output.sort();
    return output;
  };
  out$.check_clicked = check_clicked = function(){
    var sunetid;
    sunetid = $('#sunetid_input').val();
    if (sunetid == null || sunetid.length === 0) {
      alert('Please enter your SUNet ID');
      return;
    }
    $('#results_view').text('Fetching attendance records, please wait');
    return $.getJSON('/attendance?' + $.param({
      sunetid: sunetid
    }), function(results){
      var i$, ref$, len$, item;
      if (results.length === 0) {
        $('#results_view').html('No records of seminars attended for this user.<br>If any seminars are missing, please record your attendance at <a href="http://hci.st/547">http://hci.st/547</a>');
        return;
      }
      $('#results_view').html('');
      $('#results_view').append($('<div>').text('Attended the following seminars:'));
      $('#results_view').append('<br>');
      for (i$ = 0, len$ = (ref$ = sorted_by_date(results)).length; i$ < len$; ++i$) {
        item = ref$[i$];
        $('#results_view').append($('<div>').text(item));
      }
      $('#results_view').append('<br>');
      return $('#results_view').append($('<div>').html('If any seminars are missing, please record your attendance at <a href="http://hci.st/547">http://hci.st/547</a>'));
    });
  };
  out$.sunetid_keydown = sunetid_keydown = function(event){
    if (event.keyCode === 13) {
      return check_clicked();
    }
  };
  $(document).ready(function(){
    return $('#sunetid_input').focus();
  });
}).call(this);
