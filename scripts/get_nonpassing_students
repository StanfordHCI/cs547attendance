#!/usr/bin/env node
// Generated by LiveScript 1.5.0
(function(){
  var cheerio, fs, co, fetch;
  cheerio = require('cheerio');
  fs = require('fs');
  co = require('co');
  fetch = require('node-fetch');
  co(function*(){
    var $, enrolled_students, i$, ref$, len$, x, text, nopass_request, nopass_text, nopass_students, nopass_students_set, res$, enrolled_nopass_students, this$ = this;
    $ = cheerio.load(fs.readFileSync('ps.xls'));
    enrolled_students = [];
    for (i$ = 0, len$ = (ref$ = $('td')).length; i$ < len$; ++i$) {
      x = ref$[i$];
      text = $(x).text().trim();
      if (text.includes('@stanford.edu')) {
        enrolled_students.push(text);
      }
    }
    nopass_request = (yield fetch('http://cs547check.herokuapp.com/nopass'));
    nopass_text = (yield nopass_request.text());
    nopass_students = nopass_text.split('\n').map(function(it){
      return it.trim();
    }).map((function(it){
      return it + '@stanford.edu';
    }));
    res$ = {};
    for (i$ = 0, len$ = nopass_students.length; i$ < len$; ++i$) {
      x = nopass_students[i$];
      res$[x] = true;
    }
    nopass_students_set = res$;
    enrolled_nopass_students = enrolled_students.filter(function(it){
      return nopass_students_set[it];
    });
    return console.log(enrolled_nopass_students);
  });
}).call(this);
